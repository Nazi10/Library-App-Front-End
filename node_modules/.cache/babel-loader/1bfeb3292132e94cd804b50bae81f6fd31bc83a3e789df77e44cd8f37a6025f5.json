{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\WebstormProjects\\\\library\\\\src\\\\components\\\\authentication\\\\LoginComponent.js\",\n  _s = $RefreshSig$();\nimport { LoginApi } from \"../../api/LoginApi\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { Button } from \"react-bootstrap\";\nimport axios from \"axios\";\nimport { HomePage } from \"../../pages/HomePage\";\nimport useAuth from \"./useAuth\";\nimport { Link, useNavigate, useLocation } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const LoginComponent = () => {\n  _s();\n  var _location$state, _location$state$from;\n  const {\n    setAuth\n  } = useAuth;\n  const userRef = useRef();\n  const errRef = useRef();\n  const navigate = useNavigate();\n  const location = useLocation();\n  const from = ((_location$state = location.state) === null || _location$state === void 0 ? void 0 : (_location$state$from = _location$state.from) === null || _location$state$from === void 0 ? void 0 : _location$state$from.pathname) || \"/home\";\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [errMsg, setErrMsg] = useState('');\n  useEffect(() => {\n    setErrMsg('');\n  }, [email, password]);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    try {\n      var _response$data;\n      const response = await axios.post(`https://localhost:7196/api/authentication/login`, JSON.stringify({\n        email,\n        password\n      }), {\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        withCredentials: true\n      });\n      console.log(JSON.stringify(response === null || response === void 0 ? void 0 : response.data));\n      localStorage.setItem(\"token\", JSON.stringify(response.data));\n      const accessToken = response === null || response === void 0 ? void 0 : (_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.accessToken;\n      setAuth({\n        email,\n        password,\n        accessToken\n      });\n      setEmail('');\n      setPassword('');\n      navigate(from, {\n        replace: true\n      });\n    } catch (err) {\n      var _err$response, _err$response2;\n      if (!(err !== null && err !== void 0 && err.response)) {\n        setErrMsg('No Server Response');\n      } else if (((_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.status) === 400) {\n        setErrMsg('Missing Username or Password');\n      } else if (((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : _err$response2.status) === 401) {\n        setErrMsg('Unauthorized');\n      } else {\n        setErrMsg('Login Failed');\n      }\n      errRef.current.focus();\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: success ? /*#__PURE__*/_jsxDEV(HomePage, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 17\n    }, this) : /*#__PURE__*/_jsxDEV(\"section\", {\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        ref: errRef,\n        className: errMsg ? \"errmsg\" : \"offscreen\",\n        \"aria-live\": \"assertive\",\n        children: errMsg\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container\",\n        children: /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"email\",\n            children: \"Email:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"form-control\",\n            type: \"text\",\n            id: \"email\",\n            ref: userRef,\n            autoComplete: \"off\",\n            onChange: e => setEmail(e.target.value),\n            value: email,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"password\",\n            children: \"Password:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"form-control\",\n            type: \"password\",\n            id: \"password\",\n            onChange: e => setPassword(e.target.value),\n            value: password,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-primary\",\n            children: \"Login\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 17\n    }, this)\n  }, void 0, false);\n};\n_s(LoginComponent, \"494/t7tqDtEDVqJTl27z1gUap5Q=\", false, function () {\n  return [useNavigate, useLocation];\n});\n_c = LoginComponent;\nvar _c;\n$RefreshReg$(_c, \"LoginComponent\");","map":{"version":3,"names":["LoginApi","useEffect","useRef","useState","Button","axios","HomePage","useAuth","Link","useNavigate","useLocation","LoginComponent","setAuth","userRef","errRef","navigate","location","from","state","pathname","email","setEmail","password","setPassword","errMsg","setErrMsg","handleSubmit","e","preventDefault","response","post","JSON","stringify","headers","withCredentials","console","log","data","localStorage","setItem","accessToken","replace","err","status","current","focus","success","target","value"],"sources":["C:/Users/User/WebstormProjects/library/src/components/authentication/LoginComponent.js"],"sourcesContent":["import {LoginApi} from \"../../api/LoginApi\";\r\nimport { useEffect, useRef, useState} from \"react\";\r\nimport {Button} from \"react-bootstrap\";\r\nimport axios from \"axios\";\r\nimport {HomePage} from \"../../pages/HomePage\";\r\nimport useAuth from \"./useAuth\";\r\nimport { Link, useNavigate, useLocation } from 'react-router-dom';\r\n\r\nexport const LoginComponent =() => {\r\n\r\n    const { setAuth } = useAuth;\r\n    const userRef = useRef();\r\n    const errRef = useRef();\r\n\r\n    const navigate = useNavigate();\r\n    const location = useLocation();\r\n    const from = location.state?.from?.pathname || \"/home\";\r\n\r\n    const [email, setEmail] = useState(\"\");\r\n    const [password, setPassword] = useState(\"\");\r\n    const [errMsg, setErrMsg] = useState('');\r\n\r\n    useEffect(() => {\r\n        setErrMsg('');\r\n    }, [email, password])\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        try {\r\n            const response = await axios.post(\r\n                `https://localhost:7196/api/authentication/login`,\r\n                JSON.stringify({ email, password }),\r\n                {\r\n                    headers: { 'Content-Type': 'application/json' },\r\n                    withCredentials: true\r\n                }\r\n            );\r\n            console.log(JSON.stringify(response?.data));\r\n            localStorage.setItem(\"token\", JSON.stringify(response.data))\r\n            const accessToken = response?.data?.accessToken;\r\n            setAuth({ email, password, accessToken });\r\n            setEmail('');\r\n            setPassword('');\r\n            navigate(from, { replace: true });\r\n        } catch (err) {\r\n            if (!err?.response) {\r\n                setErrMsg('No Server Response');\r\n            } else if (err.response?.status === 400) {\r\n                setErrMsg('Missing Username or Password');\r\n            } else if (err.response?.status === 401) {\r\n                setErrMsg('Unauthorized');\r\n            } else {\r\n                setErrMsg('Login Failed');\r\n            }\r\n            errRef.current.focus();\r\n        }\r\n    }\r\n\r\n    return (\r\n        <>\r\n            {success ? (\r\n                <HomePage/>\r\n            ) : (\r\n                <section>\r\n                    <p ref={errRef} className={errMsg ? \"errmsg\" : \"offscreen\"} aria-live=\"assertive\">{errMsg}</p>\r\n                    <h1>Login</h1>\r\n                    <div className=\"container\">\r\n                    <form onSubmit={handleSubmit}>\r\n                        <label htmlFor=\"email\">Email:</label>\r\n                        <input\r\n                            className=\"form-control\"\r\n                            type=\"text\"\r\n                            id=\"email\"\r\n                            ref={userRef}\r\n                            autoComplete=\"off\"\r\n                            onChange={(e) => setEmail(e.target.value)}\r\n                            value={email}\r\n                            required\r\n                        ></input>\r\n                        <label htmlFor=\"password\">Password:</label>\r\n                        <input\r\n                            className=\"form-control\"\r\n                            type=\"password\"\r\n                            id=\"password\"\r\n                            onChange={(e) => setPassword(e.target.value)}\r\n                            value={password}\r\n                            required\r\n                        />\r\n                        <p/>\r\n                        <button className=\"btn btn-primary\">Login</button>\r\n                    </form>\r\n                    </div>\r\n                </section>\r\n            )}\r\n        </>\r\n    )\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}